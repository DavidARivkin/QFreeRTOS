<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>QFreeRTOS: source/portable/RVDS/ARM7_LPC21xx/portmacro.inc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QFreeRTOS
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Qt port of FreeRTOS (Simulation)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_a_r_m7___l_p_c21xx_2portmacro_8inc_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">portmacro.inc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_a_r_m7___l_p_c21xx_2portmacro_8inc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">;    FreeRTOS V8.2.3 - Copyright (C) 2015 Real Time Engineers Ltd.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">;    All rights reserved</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">;   </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">;    ***************************************************************************</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">;     *                                                                       *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">;     *    FreeRTOS tutorial books are available in pdf and paperback.        *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">;     *    Complete, revised, and edited pdf reference manuals are also       *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">;     *    available.                                                         *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">;     *                                                                       *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">;     *    Purchasing FreeRTOS documentation will not only help you, by       *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">;     *    ensuring you get running as quickly as possible and with an        *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">;     *    in-depth knowledge of how to use FreeRTOS, it will also help       *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">;     *    the FreeRTOS project to continue with its mission of providing     *</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">;     *    professional grade, cross platform, de facto standard solutions    *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">;     *    for microcontrollers - completely free of charge!                  *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">;     *                                                                       *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">;     *    &gt;&gt;&gt; See http://www.FreeRTOS.org/Documentation for details. &lt;&lt;&lt;     *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">;     *                                                                       *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">;     *    Thank you for using FreeRTOS, and thank you for your support!      *</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">;     *                                                                       *</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">;    ***************************************************************************</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">;    This file is part of the FreeRTOS distribution.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">;    FreeRTOS is free software; you can redistribute it and/or modify it under</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">;    the terms of the GNU General Public License (version 2) as published by the</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">;    Free Software Foundation AND MODIFIED BY the FreeRTOS exception.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">;    &gt;&gt;&gt;NOTE&lt;&lt;&lt; The modification to the GPL is included to allow you to</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">;    distribute a combined work that includes FreeRTOS without being obliged to</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">;    provide the source code for proprietary components outside of the FreeRTOS</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">;    kernel.  FreeRTOS is distributed in the hope that it will be useful, but</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">;    WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">;    or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">;    more details. You should have received a copy of the GNU General Public</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">;    License and the FreeRTOS license exception along with FreeRTOS; if not it</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">;    can be viewed here: http://www.freertos.org/a00114.html and also obtained</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">;    by writing to Richard Barry, contact details for whom are available on the</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">;    FreeRTOS WEB site.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">;    1 tab == 4 spaces!</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">;    http://www.FreeRTOS.org - Documentation, latest information, license and</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">;    contact details.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">;    http://www.SafeRTOS.com - A version that is certified for use in safety</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">;    critical systems.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">;    http://www.OpenRTOS.com - Commercial support, development, porting,</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">;    licensing and training services.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">;*/</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    IMPORT  <a class="code" href="_c_c_s_2_a_r_m___cortex-_r4_2port_8c.html#abd5c4f2fdb773b389a89cf1bb14f22c8">ulCriticalNesting</a>       ;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    IMPORT  <a class="code" href="_b_c_c_216_bit_d_o_s_2common_2portasm_8h.html#a7cd782382601a8809780a8b6e8ffe570">pxCurrentTCB</a>            ;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ada307cac855884c6cb4493eaa3663de7">MACRO</a></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="_i_a_r_2_v850_e_s_2portmacro_8h.html#a716d176e9130fa97ac875a31e7453605">portRESTORE_CONTEXT</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    LDR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>, =<a class="code" href="_b_c_c_216_bit_d_o_s_2common_2portasm_8h.html#a7cd782382601a8809780a8b6e8ffe570">pxCurrentTCB</a>       ; Set <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a> <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#a2556ddfc4320378f314de3661ceed4c2">to</a> <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> task <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a>.  The location was...</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    LDR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>, [<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>]                ; ... stored in <a class="code" href="_b_c_c_216_bit_d_o_s_2common_2portasm_8h.html#a7cd782382601a8809780a8b6e8ffe570">pxCurrentTCB</a></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    LDR     <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, [<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>]</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    LDR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>, =<a class="code" href="_c_c_s_2_a_r_m___cortex-_r4_2port_8c.html#abd5c4f2fdb773b389a89cf1bb14f22c8">ulCriticalNesting</a>  ; The critical nesting depth is <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> first item on... </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    LDMFD   <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>!, {<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#aff27e396da762779404affb9cf6aef61">R1</a>}               ; ...the <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a>.  Load it into <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <a class="code" href="_c_c_s_2_a_r_m___cortex-_r4_2port_8c.html#abd5c4f2fdb773b389a89cf1bb14f22c8">ulCriticalNesting</a> var.</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    STR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#aff27e396da762779404affb9cf6aef61">R1</a>, [<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>]                ;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    LDMFD   <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>!, {<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>}               ; Get <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> SPSR from <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a>.</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    MSR     SPSR_cxsf, <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>           ;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    LDMFD   <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, {<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>-R14}^           ; Restore all system mode <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#a3de5611e92ac83d85441f23bf7c14cf7">registers</a> <span class="keywordflow">for</span> <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> task.</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    NOP                             ;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    LDR     <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, [<a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, #+60]          ; Restore <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <span class="keywordflow">return</span> address</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                    ; And <span class="keywordflow">return</span> - correcting <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <a class="code" href="_m_p_l_a_b_2_p_i_c32_m_z_2_i_s_r___support_8h.html#a12a5aed8a193ebbf9a641104a310610d">offset</a> in <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a> <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#a2556ddfc4320378f314de3661ceed4c2">to</a> obtain ...</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    SUBS    <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#a8c2d0d370cca772111890ac230f68c35">PC</a>, <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, #4              ; ...the correct address.</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    MEND</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;; <span class="comment">/**********************************************************************/</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ada307cac855884c6cb4493eaa3663de7">MACRO</a></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="_i_a_r_2_v850_e_s_2portmacro_8h.html#ad79a8b96e1489f7f0645e8d57360337d">portSAVE_CONTEXT</a></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    STMDB   <a class="code" href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a>!, {<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>}               ; Store <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a> first as we need <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#a2556ddfc4320378f314de3661ceed4c2">to</a> use it.</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    STMDB   <a class="code" href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a>,{<a class="code" href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a>}^                ; Set <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a> <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#a2556ddfc4320378f314de3661ceed4c2">to</a> point <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#a2556ddfc4320378f314de3661ceed4c2">to</a> <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> task <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a> pointer.</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    NOP                             ;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    SUB     <a class="code" href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a>, <a class="code" href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a>, #4              ;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    LDMIA   <a class="code" href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a>!,{<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>}                ;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    STMDB   <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>!, {<a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>}               ; Push <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <span class="keywordflow">return</span> address onto <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a>.</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MOV     <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>                  ; Now we have saved <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a> we can use it instead of <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>.</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    LDMIA   <a class="code" href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a>!, {<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>}               ; Pop <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a> so we can save it onto <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> system mode <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a>.</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    STMDB   <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>,{<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>-<a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>}^             ; Push all <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> system mode <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#a3de5611e92ac83d85441f23bf7c14cf7">registers</a> onto <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> task <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a>.</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    NOP                             ;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    SUB     <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, #60             ;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    MRS     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>, SPSR                ; Push <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> SPSR onto <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> task <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a>.</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    STMDB   <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>!, {<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>}               ;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    LDR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>, =<a class="code" href="_c_c_s_2_a_r_m___cortex-_r4_2port_8c.html#abd5c4f2fdb773b389a89cf1bb14f22c8">ulCriticalNesting</a>  ;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    LDR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>, [<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>]                ;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    STMDB   <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>!, {<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>}               ;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    LDR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>, =<a class="code" href="_b_c_c_216_bit_d_o_s_2common_2portasm_8h.html#a7cd782382601a8809780a8b6e8ffe570">pxCurrentTCB</a>       ; Store <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> <span class="keyword">new</span> top of <a class="code" href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a> <span class="keywordflow">for</span> <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a> task.</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    LDR     <a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#aff27e396da762779404affb9cf6aef61">R1</a>, [<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a>]                ;        </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    STR     <a class="code" href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a>, [<a class="code" href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#aff27e396da762779404affb9cf6aef61">R1</a>]                ;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    MEND</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    END</div>
<div class="ttc" id="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h_html_aea250a9501de6f05bc594cf2e82287ea"><div class="ttname"><a href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aea250a9501de6f05bc594cf2e82287ea">LR</a></div><div class="ttdeci">Push R0 as we are going to use the register STMDB Set R0 to point to the task stack pointer STMDB LDMIA Push the return address onto the stack STMDB Now we have saved LR we can use it instead of R0 MOV LR</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h_source.html#l00073">ISR_Support.h:73</a></div></div>
<div class="ttc" id="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h_html_a8c2d0d370cca772111890ac230f68c35"><div class="ttname"><a href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#a8c2d0d370cca772111890ac230f68c35">PC</a></div><div class="ttdeci">correct address SUBS PC</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h_source.html#l00128">ISR_Support.h:128</a></div></div>
<div class="ttc" id="_m_p_l_a_b_2_p_i_c32_m_z_2_i_s_r___support_8h_html_a12a5aed8a193ebbf9a641104a310610d"><div class="ttname"><a href="_m_p_l_a_b_2_p_i_c32_m_z_2_i_s_r___support_8h.html#a12a5aed8a193ebbf9a641104a310610d">offset</a></div><div class="ttdeci">macro portSAVE_FPU_REGS offset</div><div class="ttdef"><b>Definition:</b> <a href="_m_p_l_a_b_2_p_i_c32_m_z_2_i_s_r___support_8h_source.html#l00080">ISR_Support.h:80</a></div></div>
<div class="ttc" id="_i_a_r_278_k0_r_2_i_s_r___support_8h_html_ada307cac855884c6cb4493eaa3663de7"><div class="ttname"><a href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ada307cac855884c6cb4493eaa3663de7">MACRO</a></div><div class="ttdeci">portSAVE_CONTEXT MACRO</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_278_k0_r_2_i_s_r___support_8h_source.html#l00063">ISR_Support.h:63</a></div></div>
<div class="ttc" id="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h_html_ab71e6f94394636766ac73443d5268517"><div class="ttname"><a href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#ab71e6f94394636766ac73443d5268517">R0</a></div><div class="ttdeci">Save the stack pointer in the TCB LDR R0</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h_source.html#l00092">portASM.h:92</a></div></div>
<div class="ttc" id="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h_html_a2556ddfc4320378f314de3661ceed4c2"><div class="ttname"><a href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#a2556ddfc4320378f314de3661ceed4c2">to</a></div><div class="ttdeci">Save the LR and SPSR onto the system mode stack before switching to</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h_source.html#l00064">portASM.h:64</a></div></div>
<div class="ttc" id="_i_a_r_2_v850_e_s_2portmacro_8h_html_a716d176e9130fa97ac875a31e7453605"><div class="ttname"><a href="_i_a_r_2_v850_e_s_2portmacro_8h.html#a716d176e9130fa97ac875a31e7453605">portRESTORE_CONTEXT</a></div><div class="ttdeci">void portRESTORE_CONTEXT(void)</div></div>
<div class="ttc" id="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h_html_aff27e396da762779404affb9cf6aef61"><div class="ttname"><a href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h.html#aff27e396da762779404affb9cf6aef61">R1</a></div><div class="ttdeci">ulPortTaskHasFPUContext is then no LDR CMP Save the floating point if any FMRXNE R1</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h_source.html#l00076">portASM.h:76</a></div></div>
<div class="ttc" id="_i_a_r_278_k0_r_2_i_s_r___support_8h_html_ab327b64f028ec1b108340d3378d45d45"><div class="ttname"><a href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#ab327b64f028ec1b108340d3378d45d45">stack</a></div><div class="ttdeci">of the active Task onto the task stack</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_278_k0_r_2_i_s_r___support_8h_source.html#l00067">ISR_Support.h:67</a></div></div>
<div class="ttc" id="_g_c_c_2_r_l78_2_i_s_r___support_8h_html_a85224ff891d5fa22f8aa26c3eaca34f1"><div class="ttname"><a href="_g_c_c_2_r_l78_2_i_s_r___support_8h.html#a85224ff891d5fa22f8aa26c3eaca34f1">SP</a></div><div class="ttdeci">_pxCurrentTCB _usCriticalNesting macro portSAVE_CONTEXT SEL RB0 PUSH AX PUSH HL MOV CS XCH X MOV ES PUSH AX PUSH DE PUSH BC SEL RB1 PUSH AX PUSH BC PUSH DE PUSH HL SEL RB2 PUSH AX PUSH BC PUSH DE PUSH HL SEL RB0 MOVW!_usCriticalNesting PUSH AX MOVW!_pxCurrentTCB MOVW AX MOVW SP AX movw endm macro portRESTORE_CONTEXT MACRO SEL RB0 MOVW!_pxCurrentTCB MOVW AX MOVW MOVW SP</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_2_a_r_m___c_a5___no___g_i_c_2portasm_8h_source.html#l00103">portASM.h:103</a></div></div>
<div class="ttc" id="_b_c_c_216_bit_d_o_s_2common_2portasm_8h_html_a7cd782382601a8809780a8b6e8ffe570"><div class="ttname"><a href="_b_c_c_216_bit_d_o_s_2common_2portasm_8h.html#a7cd782382601a8809780a8b6e8ffe570">pxCurrentTCB</a></div><div class="ttdeci">volatile TCB_t *volatile pxCurrentTCB</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_278_k0_r_2_i_s_r___support_8h_source.html#l00094">ISR_Support.h:94</a></div></div>
<div class="ttc" id="_c_c_s_2_a_r_m___cortex-_r4_2port_8c_html_abd5c4f2fdb773b389a89cf1bb14f22c8"><div class="ttname"><a href="_c_c_s_2_a_r_m___cortex-_r4_2port_8c.html#abd5c4f2fdb773b389a89cf1bb14f22c8">ulCriticalNesting</a></div><div class="ttdeci">uint32_t ulCriticalNesting</div><div class="ttdef"><b>Definition:</b> <a href="_c_c_s_2_a_r_m___cortex-_r4_2port_8c_source.html#l00077">port.c:77</a></div></div>
<div class="ttc" id="_i_a_r_278_k0_r_2_i_s_r___support_8h_html_a3de5611e92ac83d85441f23bf7c14cf7"><div class="ttname"><a href="_i_a_r_278_k0_r_2_i_s_r___support_8h.html#a3de5611e92ac83d85441f23bf7c14cf7">registers</a></div><div class="ttdeci">Saves the context of the general purpose registers</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_278_k0_r_2_i_s_r___support_8h_source.html#l00064">ISR_Support.h:64</a></div></div>
<div class="ttc" id="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h_html_aef4e93322d3b4e7f5270e9b89fe30753"><div class="ttname"><a href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h.html#aef4e93322d3b4e7f5270e9b89fe30753">the</a></div><div class="ttdeci">Restore all system mode registers for the task LDMFD Restore the return address LDR And return correcting the offset in the LR to obtain the</div><div class="ttdef"><b>Definition:</b> <a href="_i_a_r_2_atmel_s_a_m7_s64_2_i_s_r___support_8h_source.html#l00120">ISR_Support.h:120</a></div></div>
<div class="ttc" id="_i_a_r_2_v850_e_s_2portmacro_8h_html_ad79a8b96e1489f7f0645e8d57360337d"><div class="ttname"><a href="_i_a_r_2_v850_e_s_2portmacro_8h.html#ad79a8b96e1489f7f0645e8d57360337d">portSAVE_CONTEXT</a></div><div class="ttdeci">void portSAVE_CONTEXT(void)</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_a3bc36d27ac900b14f04c9e2c43db8b5.html">portable</a></li><li class="navelem"><a class="el" href="dir_033da7e77bbf006ab48b2e7d50b8e21e.html">RVDS</a></li><li class="navelem"><a class="el" href="dir_e7d80831831b7dbe6d54851b8fa4f5f9.html">ARM7_LPC21xx</a></li><li class="navelem"><a class="el" href="_a_r_m7___l_p_c21xx_2portmacro_8inc.html">portmacro.inc</a></li>
    <li class="footer">Generated on Thu Feb 4 2016 15:55:41 for QFreeRTOS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
